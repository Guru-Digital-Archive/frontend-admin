/*
 *  Silverstripe front end admin  - v0.1
 *  Front end admin for Silverstripe
 *  
 *
 *  Made by Corey Sewell - Guru Digital Media
 *  Under BSD License
 */
!function(a){a(function(){a.entwine("ss.frontEndAdmin",function(a){a("div.admin-panel").entwine({OpenPosition:0,ClosedPosition:0,AdminBtn:a("<button>").addClass("btn btn-default").attr("id","adminToggle").text(frontEndAdmin.toggleLabel),AdminBtnWrap:a("<div>").addClass("admin-panel-taggle-wrap"),AdminFrame:a("<iframe>").attr("id","admin-frame").attr("src",frontEndAdmin.editHref+"?frontEndAdmin=true"),AdminFrameWrap:a("<div>").addClass("admin-frame-wrap"),onmatch:function(){var b=this;b.append(b.getAdminFrameWrap().append(b.getAdminFrame())).append(b.getAdminBtnWrap().append(b.getAdminBtn())),b.calculatePositions().hide().removeClass("admin-menu-hide").css({left:b.getClosedPosition()}).fadeIn(function(){b.draggable({handle:b.getAdminBtnWrap().parent(),axis:"y"}),b.getAdminFrameWrap().resizable({stop:function(){a("div.admin-panel").calculatePositions()}})})},toggleAdmin:function(b,c){var d=400,e=this,f=parseInt(e.position().left,10),g=f>=e.getOpenPosition()?e.getClosedPosition():e.getOpenPosition();"undefined"!=typeof b&&(g=b?e.getOpenPosition():e.getClosedPosition()),b=g===e.getOpenPosition(),setTimeout(function(){e.getAdminBtn().setIcon(b?frontEndAdmin.toggleIconOpen:frontEndAdmin.toggleIconClosed)},d/2),e.animate({left:g},d,"easeInBack",function(){a.isFunction(c)&&c.apply(e,b)})},calculatePositions:function(){return this.setOpenPosition(-(parseInt(this.css("padding-left"),10)+parseInt(this.css("margin-left"),10)-parseInt(this.css("padding-right"),10)/2)),this.setClosedPosition(-(this.outerWidth()+parseInt(this.css("margin-left"),10))),this}}),a("#adminToggle").entwine({onmatch:function(){this.button({icons:{secondary:frontEndAdmin.toggleIconClosed}})},onclick:function(){a("div.admin-panel").toggleAdmin()},setIcon:function(a){this.button({icons:{secondary:a}})}}),a("#admin-frame").entwine({onmatch:function(){this.load(function(){var b=a(this)[0].contentWindow,c=b.jQuery;c("#preview-mode-dropdown-in-content").entwine({onmatch:function(){this.remove()}}),c.ajaxSetup({beforeSend:function(a){a.setRequestHeader("X-FRONT-END-ADMIN","true")}})})}}),a("<div>").addClass("admin-panel admin-menu-hide").appendTo(a("body"))})})}(jQuery);