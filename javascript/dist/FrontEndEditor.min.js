/*
 *  Silverstripe front end admin  - v0.1
 *  Front end admin for Silverstripe
 *  
 *
 *  Made by Corey Sewell - Guru Digital Media
 *  Under BSD-3-Clause License
 */
var frontEndAdmin=frontEndAdmin||{};!function(a){function b(b){var c="",e=a(b.getElement()),f={fefield:e.data("fefield"),feid:e.data("feid"),feclass:e.data("feclass"),value:b.getContent()},g=d({content:"Saving "+f.fefield,type:"loading"});e.data("originalContent",b.getContent()),c=a(f.value),c.find(".ss-htmleditorfield-file.embed").each(function(){var b=a(this),c="[embed width='"+b.attr("width")+"' height='"+b.attr("height")+"' class='"+b.data("cssclass")+"' thumbnail='"+b.data("thumbnail")+"']"+b.data("url")+"[/embed]";b.replaceWith(c)}),c.length&&(f.value=a("<div />").append(c).html()),b.getBody().setAttribute("contenteditable","false"),a.post(frontEndAdmin.baseHref+"home/fesave",f,function(a){g.hide(),b.getBody().setAttribute("contenteditable","true"),d(a)})}function c(){var b=a(this),c={fefield:b.data("fefield"),feid:b.data("feid"),feclass:b.data("feclass"),value:this.val()},e=d({content:"Saving "+c.fefield,type:"loading"});b.prop("disabled",!0),a.post(frontEndAdmin.baseHref+"home/fesave",c,function(a){e.hide(),b.prop("disabled",!1),d(a)})}function d(a){var b;if("string"==typeof a&&(a={content:a}),"string"==typeof a.content){switch("string"!=typeof a.type&&(a.type="info"),a.type){case"good":case"success":b=toastr.success(a.content,a.title,a.options);break;case"bad":case"error":b=toastr.error(a.content,a.title,a.options);break;case"warning":case"warn":b=toastr.warning(a.content,a.title,a.options);break;case"loading":a.options={extendedTimeOut:0,timeOut:0,iconClass:"toast-info toast-icon-loading"},b=toastr.warning(a.content,a.title,a.options);break;default:b=toastr.info(a.content,a.title,a.options)}return b}}if(frontEndAdmin.baseHref=a("base").attr("href"),a(function(){"undefined"==typeof toastr&&a.getScript(frontEndAdmin.baseHref+"silverstripe-frontend-admin/javascript/thirdparty/toastr.min.js")}),-1!==a("title").text().search("<")){var e=a(a("title").text());a("title").html(e.text())}frontEndAdmin.tinymceGlobalDefaults={inline:!0,save_enablewhendirty:!1,save_onsavecallback:b,script_url:frontEndAdmin.baseHref+"silverstripe-frontend-admin/javascript/thirdparty/tinymce/js/tinymce/tinymce.min.js"},frontEndAdmin.tinymceDefaults=a.extend({},frontEndAdmin.tinymceGlobalDefaults,{plugins:["save advlist autolink lists image charmap print preview hr anchor pagebreak","searchreplace wordcount visualblocks visualchars code fullscreen","insertdatetime media nonbreaking save table contextmenu directionality","emoticons template paste textcolor  nonbreaking SSFEButtons"],toolbar1:"save undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | ssfeLink ssfeimage",toolbar2:"print preview media | forecolor backcolor emoticons",contextmenu:"ssfeLink ssfeimage inserttable | cell row column deletetable",image_advtab:!0,remove_script_host:!0,convert_urls:!0,relative_urls:!0,document_base_url:frontEndAdmin.baseHref,extended_valid_elements:"-p[style|class]"}),frontEndAdmin.tinymceVarCharDefaults=a.extend({},frontEndAdmin.tinymceGlobalDefaults,{plugins:["save "],toolbar1:"save cancel undo redo ",menubar:!1,statusbar:!1,toolbar_items_size:"small"}),a(".frontend-editable-varchar").entwine({onmatch:function(){this.tinymce(frontEndAdmin.tinymceVarCharDefaults)}}),a(".frontend-editable-html").entwine({onmatch:function(){this.tinymce(frontEndAdmin.tinymceDefaults)}}),a(".frontend-editable-enum").entwine({onchange:c}),a(".frontend-editable-boolean").entwine({onchange:c})}(jQuery);